# basic

- [basic](#basic)
  - [Components](#components)
  - [Features](#features)
  - [Usage](#usage)
    - [Deploying with terraform](#deploying-with-terraform)
    - [Adding an API consumer](#adding-an-api-consumer)
      - [Adding an API consumer via the API](#adding-an-api-consumer-via-the-api)
      - [Viewing API consumers](#viewing-api-consumers)
    - [Viewing usage for an API consumer](#viewing-usage-for-an-api-consumer)
    - [Troubleshooting API consumer access](#troubleshooting-api-consumer-access)
    - [Updating an API consumer](#updating-an-api-consumer)
    - [Disabling an API consumer](#disabling-an-api-consumer)

## Components

- API Gateway
- Lambda Authorizer
- Lambda
- Parameter Store
- Terraform

## Features

- Reads available roles and policies from Lambda environment variables
- Looks up consumer credentials in the Parameter Store
- Looks up consumer API key in the Parameter Store

## Usage

### Deploying with terraform

```
terraform init
terraform apply
```

### Adding an API consumer

```
{
  "password": "1234",
  "role": "creator"
  "apiKey": "something"
}
```

#### Adding an API consumer via the API

```
REQUEST
POST /consumers
"Authorization": "SomeAdminApiKey"
{
  "username": "MyBackendService",
  "role": "SomeRole"
}
RESPONSE
{
  "username": "MyBackendService",
  "password": "AutogeneratedPassword",
  "role": "SomeRole",
  "apiKey": "AutogeneratedApiKey"
}
```

#### Viewing API consumers

```
REQUEST
GET /consumers
RESPONSE
[
  {
    "username": "MyBackendService",
    "role": "SomeRole",
    "usage": "https://example.com/usage"
  }
]
```

```
REQUEST
GET /consumers.html
RESPONSE
Shows consumers, and provides an `add consumer` button and form
```

### Viewing usage for an API consumer

### Troubleshooting API consumer access

### Updating an API consumer

### Disabling an API consumer
